{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, vShow as _vShow, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '../../assets/attach.png';\nimport _imports_1 from '../../assets/remove.png';\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-39e412ee\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", null, \"MVC 게시판-write 페이지\", -1\n/* HOISTED */\n));\n\nconst _hoisted_2 = {\n  class: \"form-group\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"board_name\"\n}, \"글쓴이\", -1\n/* HOISTED */\n));\n\nconst _hoisted_4 = [\"value\"];\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\n\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"board_subject\"\n}, \"제목\", -1\n/* HOISTED */\n));\n\nconst _hoisted_7 = {\n  class: \"form-group\"\n};\n\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"board_content\"\n}, \"내용\", -1\n/* HOISTED */\n));\n\nconst _hoisted_9 = {\n  key: 0,\n  class: \"form-group\"\n};\n\nconst _hoisted_10 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"board_file\"\n}, \"파일 첨부\", -1\n/* HOISTED */\n));\n\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0,\n  alt: \"파일첨부\"\n}, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_12 = {\n  class: \"form-group\"\n};\n\nconst _hoisted_13 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"board_pass\"\n}, \"비밀번호\", -1\n/* HOISTED */\n));\n\nconst _hoisted_14 = {\n  class: \"form-group\"\n};\n\nconst _hoisted_15 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  class: \"btn btn-primary\"\n}, \"수정\", -1\n/* HOISTED */\n));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"form\", {\n    onSubmit: _cache[6] || (_cache[6] = _withModifiers((...args) => $setup.update && $setup.update(...args), [\"prevent\"]))\n  }, [_hoisted_1, _createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"input\", {\n    readonly: \"\",\n    value: $setup.board.baord_NAME,\n    type: \"text\",\n    maxlength: \"30\",\n    class: \"form-control\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_4)]), _createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.board.board_SUBJECT = $event),\n    required: \"\",\n    maxlength: \"100\",\n    class: \"form-control\",\n    placeholder: \"Enter board_subject\"\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelText, $setup.board.board_SUBJECT, void 0, {\n    lazy: true\n  }]])]), _createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.board.board_CONTENT = $event),\n    required: \"\",\n    rows: \"10\",\n    class: \"form-control\"\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelText, $setup.board.board_CONTENT, void 0, {\n    lazy: true\n  }]])]), $setup.board.board_RE_LEV == 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_hoisted_10, _createElementVNode(\"label\", null, [_hoisted_11, _withDirectives(_createElementVNode(\"input\", {\n    type: \"file\",\n    name: \"uploadfile\",\n    onChange: _cache[2] || (_cache[2] = (...args) => $setup.change && $setup.change(...args))\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vShow, false]])]), _createElementVNode(\"span\", null, _toDisplayString($setup.fileName), 1\n  /* TEXT */\n  ), $setup.fileName ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 0,\n    src: _imports_1,\n    alt: \"파일삭제\",\n    class: \"remove\",\n    onClick: _cache[3] || (_cache[3] = (...args) => $setup.remove && $setup.remove(...args))\n  })) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_12, [_hoisted_13, _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.board.baord_PASS = $event),\n    maxlength: \"30\",\n    required: \"\",\n    placeholder: \"Enter board_pass\",\n    class: \"form-control\"\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelText, $setup.board.baord_PASS, void 0, {\n    lazy: true\n  }]])]), _createElementVNode(\"div\", _hoisted_14, [_hoisted_15, _createElementVNode(\"button\", {\n    type: \"reset\",\n    class: \"btn btn-danger\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $setup.goDetail && $setup.goDetail(...args))\n  }, \"취소\")])], 32\n  /* HYDRATE_EVENTS */\n  )]);\n}","map":{"version":3,"mappings":"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","names":["_imports_0","_imports_1","_createElementVNode","class","for","src","alt","type","_createElementBlock","onSubmit","$setup","_hoisted_1","_hoisted_3","readonly","value","baord_NAME","maxlength","_hoisted_6","board_SUBJECT","$event","required","placeholder","_hoisted_8","board_CONTENT","rows","board_RE_LEV","_hoisted_10","_hoisted_11","name","onChange","_toDisplayString","onClick","_hoisted_13","baord_PASS","_hoisted_15"],"sourceRoot":"","sources":["C:\\vue_project\\vue3-first\\src\\ex18_component_store\\component\\board\\board_update.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <form @submit.prevent=\"update\">\r\n        <h1>MVC 게시판-write 페이지</h1>\r\n        <div class=\"form-group\">\r\n            <label for=\"board_name\">글쓴이</label>\r\n            <input \r\n                    readonly \r\n                    :value=\"board.baord_NAME\" \r\n                    type=\"text\"\r\n                    maxlength=\"30\" \r\n                    class=\"form-control\">\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n            <label for=\"board_subject\">제목</label>\r\n            <input \r\n                  type=\"text\" \r\n                  v-model.lazy=\"board.board_SUBJECT\" \r\n                  required\r\n                  maxlength=\"100\" \r\n                  class=\"form-control\" \r\n                  placeholder=\"Enter board_subject\">\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n            <label for=\"board_content\">내용</label>\r\n            <textarea \r\n                    v-model.lazy=\"board.board_CONTENT\"\r\n                    required\r\n                    rows=\"10\" \r\n                    class=\"form-control\"></textarea>\r\n        </div>\r\n\r\n        <div class=\"form-group\" v-if=\"board.board_RE_LEV==0\">\r\n            <label for=\"board_file\">파일 첨부</label>\r\n            <label>\r\n            <img src=\"../../assets/attach.png\" alt=\"파일첨부\">\r\n                <input \r\n                    type=\"file\"  name=\"uploadfile\"  v-show=\"false\"  @change=\"change\">\r\n            </label>\r\n            <span>{{fileName}}</span>\r\n            <img src=\"../../assets/remove.png\" alt=\"파일삭제\" class=\"remove\"\r\n                    v-if=\"fileName\"\r\n                    @click=\"remove\">\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n        <label for=\"board_pass\">비밀번호</label>\r\n            <input \r\n                    type=\"password\"\r\n                    v-model.lazy=\"board.baord_PASS\" \r\n                    maxlength=\"30\" \r\n                    required\r\n                    placeholder=\"Enter board_pass\"\r\n                    class=\"form-control\">\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n            <button type=\"submit\" class=\"btn btn-primary\">수정</button>\r\n            <button type=\"reset\" class=\"btn btn-danger\"  @click=\"goDetail\">취소</button>\r\n        </div>\r\n    </form>\r\n </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from \"vue\";\r\nimport axios from \"../../axios/axiossetting.js\";\r\nimport {useRoute, useRouter} from \"vue-router\";\r\nexport default {\r\n    props:{\r\n        parent_id:{\r\n            type:String,\r\n            required:false\r\n        }\r\n    },\r\n    emits:['parent_getSession'],\r\n    setup(props, context){\r\n        context.emit(\"parent_getSession\");\r\n\r\n        const fileName=ref(\"\");\r\n        const board = ref({});\r\n        let file = '';\r\n        const router = useRouter();\r\n        const num = useRoute().params.num;\r\n        let check=0;\r\n\r\n        const getDetail = async ()=>{\r\n            try{\r\n                    console.log(\"num\"+num);\r\n                    const res = await axios.get(`board/${num}`);\r\n                    //const res = await axios.get('board/'+num);\r\n                    console.log(res.data);\r\n                    board.value = res.data.baord;\r\n                    if(board.value == null){\r\n                        console.log('null입니다.');\r\n                        router.push(\"{name:'404'}\")\r\n                        return;\r\n                    }\r\n                    //\"board_ORIGINAL\" :null로 전송된 경우 fileName.value=null입니다.\r\n                    fileName.value=board.value.board_ORIGINAL;\r\n                    console.log(\"파일이름 = \"+fileName.value);\r\n\r\n                    board.value.baord_PASS=\"\";\r\n            }catch(err){\r\n                console.log(err)\r\n            }\r\n        }\r\n\r\n        getDetail();\r\n\r\n        const change = event =>{\r\n            file=event.target.files[0];\r\n            fileName.value = file.name;\r\n            check++;\r\n        }\r\n\r\n        const update = async()=>{\r\n            let frm=new FormData();\r\n            if(file!=''){//let file=''; 초기값 상태가 아닌지 확인합니다.\r\n                frm.append(\"updatefile\",file);\r\n            }\r\n            frm.append(\"BOARD_CONTENT\",board.value.baord_SUBJECT);\r\n            frm.append(\"BOARD_PASS\",board.value.baord_PASS);\r\n            frm.append(\"BOARD_NAME\",board.value.baord_NAME);\r\n            frm.append(\"BOARD_NUM\",num);\r\n\r\n            if(check==0 && fileName.value != null){\r\n                frm.append(\"check\", fileName.value);\r\n                frm.append(\"BOARD_FILE\", baord.value.board_FILE);\r\n            }\r\n\r\n            try{\r\n                    const res = await axios.patch('boards',\r\n                    frm\r\n                        ,\r\n                        { headers : \r\n                                { 'Content-Type' : 'multipart/form-data;charset=UTF-8' }        \r\n                        }\r\n                    );\r\n\r\n                    console.log(`수정 응답 : ${res.data}`);\r\n                    if(res.data==\"Nopass\"){\r\n                        alert(\"비밀번호를 확인하세요\");\r\n                    }else if(res.data==\"success\"){\r\n                        router.push({name : 'Board_Detail'});\r\n                    }else if(res.data==\"fail\"){\r\n                        console.log('수정 실패입니다.');\r\n                    }\r\n           }catch(err){\r\n            console.log(\"여기는 오류\");\r\n            console.log(err);\r\n           }\r\n        }//update\r\n        \r\n        const remove=()=>{\r\n            fileName.value='';\r\n        }\r\n        const goDetail=()=>{\r\n            router.push({name:'Board_Detail'})\r\n        }\r\n\r\n        return{\r\n                fileName, board,\r\n                update, change, remove, goDetail\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    .remove{\r\n      width:10px;\r\n      position:relative;\r\n      top:-10px;\r\n    }\r\n    img {\r\n      width: 20px;\r\n    }\r\n    button {\r\n      margin-right: 1em;\r\n    }\r\n    textarea{\r\n      resize: none;\r\n    }\r\n    </style>\r\n    \r\n"]},"metadata":{},"sourceType":"module"}