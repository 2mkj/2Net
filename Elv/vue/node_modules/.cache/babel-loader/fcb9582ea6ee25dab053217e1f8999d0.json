{"ast":null,"code":"import { ref } from 'vue';\nimport axios from '../../axios/axiossetting.js';\nimport { useRouter } from 'vue-router';\nexport default {\n  props: {\n    parent_id: {\n      type: String,\n      required: true\n    }\n  },\n  emits: ['parent_getSession'],\n\n  setup(props, context) {\n    //부모 컴포넌트 App.vue 의 getSession 호출합니다\n    context.emit(\"parent_getSession\");\n    const board = ref({\n      name: '',\n      pass: '',\n      content: '',\n      subject: '',\n      fileName: ''\n    });\n    let file = '';\n    const router = useRouter();\n\n    const change = event => {\n      file = event.target.files[0];\n      board.value.fileName = file.name;\n    };\n\n    const add = async () => {\n      console.log('하하');\n      let frm = new FormData();\n\n      if (file != '') {\n        //let file=''; 초기값 상태가 아닌지 확인합니다. 즉, 파일을 선택하면 선택한 파일 업로드합니다.\n        frm.append(\"uploadfile\", file);\n      }\n\n      frm.append(\"BOARD_SUBJECT\", board.value.subject);\n      frm.append(\"BOARD_CONTENT\", board.value.content);\n      frm.append(\"BOARD_PASS\", board.value.pass);\n      frm.append(\"BOARD_NAME\", props.parent_id);\n\n      try {\n        const res = await axios.post('boards/new', frm, {\n          headers: {\n            'Content-Type': 'multipart/form-data;charset=UTF-8'\n          }\n        });\n        console.log(res.data);\n        router.push({\n          name: 'Board_List'\n        });\n      } catch (err) {\n        console.log('여기는 오류');\n        console.log(err);\n      }\n    };\n\n    return {\n      board,\n      add,\n      change\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAyCA,SAASA,GAAT,QAAoB,KAApB;AACA,OAAOC,KAAP,MAAkB,6BAAlB;AACA,SAASC,SAAT,QAA0B,YAA1B;AACA,eAAe;EACXC,KAAK,EAAC;IACFC,SAAS,EAAC;MACNC,IAAI,EAAEC,MADA;MAENC,QAAQ,EAAE;IAFJ;EADR,CADK;EAOXC,KAAK,EAAC,CAAC,mBAAD,CAPK;;EASXC,KAAK,CAACN,KAAD,EAAQO,OAAR,EAAgB;IACjB;IACAA,OAAO,CAACC,IAAR,CAAa,mBAAb;IACA,MAAMC,KAAI,GAAIZ,GAAG,CAAC;MACda,IAAI,EAAC,EADS;MAEdC,IAAI,EAAE,EAFQ;MAGdC,OAAO,EAAE,EAHK;MAIdC,OAAM,EAAI,EAJI;MAKdC,QAAQ,EAAE;IALI,CAAD,CAAjB;IAOA,IAAIC,IAAG,GAAI,EAAX;IACA,MAAMC,MAAK,GAAIjB,SAAS,EAAxB;;IAEA,MAAMkB,MAAK,GAAIC,KAAI,IAAK;MACpBH,IAAI,GAACG,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAL;MACAX,KAAK,CAACY,KAAN,CAAYP,QAAZ,GAAuBC,IAAI,CAACL,IAA5B;IACJ,CAHA;;IAKA,MAAMY,GAAE,GAAI,YAAS;MACjBC,OAAO,CAACC,GAAR,CAAY,IAAZ;MACA,IAAIC,GAAE,GAAI,IAAIC,QAAJ,EAAV;;MACA,IAAGX,IAAI,IAAE,EAAT,EAAY;QAAE;QACNU,GAAG,CAACE,MAAJ,CAAW,YAAX,EAAwBZ,IAAxB;MACR;;MACQU,GAAG,CAACE,MAAJ,CAAW,eAAX,EAA2BlB,KAAK,CAACY,KAAN,CAAYR,OAAvC;MACAY,GAAG,CAACE,MAAJ,CAAW,eAAX,EAA2BlB,KAAK,CAACY,KAAN,CAAYT,OAAvC;MACAa,GAAG,CAACE,MAAJ,CAAW,YAAX,EAAwBlB,KAAK,CAACY,KAAN,CAAYV,IAApC;MACAc,GAAG,CAACE,MAAJ,CAAW,YAAX,EAAwB3B,KAAK,CAACC,SAA9B;;MAEA,IAAG;QACK,MAAM2B,GAAE,GAAI,MAAM9B,KAAK,CAAC+B,IAAN,CAAW,YAAX,EACVJ,GADU,EAGV;UAAEK,OAAM,EACJ;YAAC,gBAAiB;UAAlB;QADJ,CAHU,CAAlB;QAOAP,OAAO,CAACC,GAAR,CAAYI,GAAG,CAACG,IAAhB;QAEAf,MAAM,CAACgB,IAAP,CAAY;UACCtB,IAAG,EAAI;QADR,CAAZ;MAIP,CAdD,CAcC,OAAMuB,GAAN,EAAU;QACPV,OAAO,CAACC,GAAR,CAAY,QAAZ;QACAD,OAAO,CAACC,GAAR,CAAYS,GAAZ;MACJ;IACZ,CA7BA;;IAgCA,OAAM;MACFxB,KADE;MACKa,GADL;MACUL;IADV,CAAN;EAGJ;;AA9DW,CAAf","names":["ref","axios","useRouter","props","parent_id","type","String","required","emits","setup","context","emit","board","name","pass","content","subject","fileName","file","router","change","event","target","files","value","add","console","log","frm","FormData","append","res","post","headers","data","push","err"],"sourceRoot":"","sources":["C:\\Users\\user\\vue\\simple_vue_project\\Elv\\vue\\src\\ex18_component_store\\component\\board\\board_write.vue"],"sourcesContent":["<template>\r\n  <div>\r\n <form @submit.prevent=\"add\">\r\n  <h1>MVC 게시판-write 페이지</h1>\r\n  <div class=\"form-group\">\r\n   <label for=\"board_name\">글쓴이</label>\r\n   <!-- input 태그는 type=\"reset\"을 선택하면 모두 클리어되어 input이 아닌 태그를 사용해 값을 유지합니다. -->\r\n   <div readonly class=\"form-control\">{{parent_id}}</div>\r\n  </div>\r\n  <div class=\"form-group\">\r\n    <label for=\"board_pass\">비밀번호</label>\r\n    <input type=\"password\" v-model.lazy=\"board.pass\" maxlength=\"30\"\r\n\t\t   class=\"form-control\" placeholder=\"Enter board_pass\" required>\r\n  </div>\r\n  <div class=\"form-group\">\r\n\t<label for=\"board_subject\">제목</label>\r\n\t<input type=\"text\" v-model.lazy=\"board.subject\" maxlength=\"100\"\r\n\t\t   class=\"form-control\" placeholder=\"Enter board_subject\">\r\n  </div>\r\n  <div class=\"form-group\">\r\n\t<label for=\"board_content\">내용</label>\r\n\t<textarea v-model.lazy=\"board.content\"\r\n\t\t\t  rows=\"10\" class=\"form-control\"></textarea>\r\n  </div>\r\n  <div class=\"form-group\">\r\n \t<label>파일 첨부</label>\r\n\t<label>\r\n\t<img src=\"../../assets/attach.png\" alt=\"파일첨부\">\r\n    <input type=\"file\" v-show=\"false\" @change=\"change\">\r\n\t</label>\r\n\t<span>{{board.fileName}}</span>\r\n  </div>\r\n  <div class=\"form-group\">\r\n  \t<button type=\"submit\" class=\"btn btn-primary\">등록</button>\r\n  \t<button type=\"button\" class=\"btn btn-danger\" >취소</button>\r\n  </div>\r\n  </form>\r\n </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport axios from '../../axios/axiossetting.js';\r\nimport { useRouter } from 'vue-router';\r\nexport default {\r\n    props:{\r\n        parent_id:{\r\n            type: String,\r\n            required: true\r\n        }\r\n    },\r\n    emits:['parent_getSession'],\r\n\r\n    setup(props, context){\r\n        //부모 컴포넌트 App.vue 의 getSession 호출합니다\r\n        context.emit(\"parent_getSession\");\r\n        const board = ref({\r\n            name:'',\r\n            pass: '',\r\n            content: '',\r\n            subject : '',\r\n            fileName: ''\r\n        })\r\n        let file = '';\r\n        const router = useRouter();\r\n\r\n        const change = event => {\r\n            file=event.target.files[0];\r\n            board.value.fileName = file.name;\r\n        }\r\n\r\n        const add = async()=>{\r\n            console.log('하하');\r\n            let frm = new FormData();\r\n            if(file!=''){ //let file=''; 초기값 상태가 아닌지 확인합니다. 즉, 파일을 선택하면 선택한 파일 업로드합니다.\r\n                    frm.append(\"uploadfile\",file);\r\n            }\r\n                    frm.append(\"BOARD_SUBJECT\",board.value.subject);\r\n                    frm.append(\"BOARD_CONTENT\",board.value.content);\r\n                    frm.append(\"BOARD_PASS\",board.value.pass);\r\n                    frm.append(\"BOARD_NAME\",props.parent_id);\r\n\r\n                    try{\r\n                            const res = await axios.post('boards/new',\r\n                                    frm\r\n                                    ,\r\n                                    { headers :\r\n                                        {'Content-Type' : 'multipart/form-data;charset=UTF-8' }\r\n                                    }\r\n                            )\r\n                            console.log(res.data);\r\n\r\n                            router.push({\r\n                                         name : 'Board_List'\r\n                            });\r\n\r\n                    }catch(err){\r\n                        console.log('여기는 오류')\r\n                        console.log(err)\r\n                    }\r\n        }\r\n\r\n\r\n        return{\r\n            board, add, change\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n    img {\r\n      width: 20px;\r\n    }\r\n    button {\r\n      margin-right: 1em;\r\n    }\r\n    </style>\r\n    \r\n"]},"metadata":{},"sourceType":"module"}