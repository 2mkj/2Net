{"ast":null,"code":"import { ref, computed } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useStore } from 'vuex';\nimport axios from '../../axios/axiossetting.js';\nexport default {\n  props: {\n    parent_id: {\n      type: String,\n      required: true\n    }\n  },\n\n  setup() {\n    //baord_list.vue <router-link :to=\"{name:'Board_Detail',params:{num:`${itme.board_NUM}`}}\"로\n    //이동할때 사용된 파라미터 num을 가져옵니다.\n    const num = useRoute().params.num;\n    const board = ref({});\n    const router = useRouter();\n\n    const getDetail = async () => {\n      try {\n        const res = await axios.get(`boards/${num}`);\n        console.log(res.data);\n        board.value = res.data.board;\n\n        if (board.value == null) {\n          console.log('null입니다.');\n          router.push(\"{name:'404'}\");\n          return;\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    getDetail();\n    const store = useStore();\n    const count = computed(() => {\n      return store.state.count;\n    });\n\n    const download = async () => {\n      console.log(board.value.board_FILE);\n      console.log(board.value.board_ORIGINAL);\n\n      try {\n        //Blob(Binary Large Object: Blob객체는 text나 2진 데이터 형태로 읽을 수 있습니다.)\n        const res = await axios.get('boards/down', {\n          params: {\n            filename: board.value.board_FILE,\n            original: board.value.board_ORIGINAL\n          },\n          responseType: 'blob'\n        });\n        let bb = new Blob([res.data]); //URL.createObjectURL() 정적 메서드는 주어진 객체를 가리키는 URL을 DOMString으로 반환합니다.\n        //DOMString은 UTF-16 문자열입니다. JavaScript의 String도 UTF-16 문자열이기 때문에 DOMString 은 String으로 연결됩니\n        // 객체 URL을 해제하려면 revokeObjectURL()을 호출하세요.\n\n        let url = window.URL.createObjectURL(bb); //<a href=\"\" download=\"파일오리지널이름\">엘리먼트 생성 후 클릭=>다운로드 수행=>엘리먼트 제거\n\n        const a = document.createElement('a'); // <a> 엘리먼트 생성\n\n        let filename = board.value.board_ORIGINAL;\n        console.log(`filename=${filename}`); //Lemon.png\n\n        a.href = url;\n        a.setAttribute('download', `${filename}`);\n        a.style.cssText = 'display:none';\n        console.log(a);\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n        window.URL.revokeObjectURL(url);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    const showModal = () => {\n      //store에 값을 변경합니다.\n      store.dispatch('display', true);\n    };\n\n    return {\n      board,\n      download,\n      count,\n      showModal\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["ref","computed","useRoute","useRouter","useStore","axios","props","parent_id","type","String","required","setup","num","params","board","router","getDetail","res","get","console","log","data","value","push","err","store","count","state","download","board_FILE","board_ORIGINAL","filename","original","responseType","bb","Blob","url","window","URL","createObjectURL","a","document","createElement","href","setAttribute","style","cssText","body","appendChild","click","remove","revokeObjectURL","error","showModal","dispatch"],"sourceRoot":"","sources":["C:\\Users\\user\\vue\\simple_vue_project\\Elv\\vue\\src\\ex18_component_store\\component\\board\\board_detail.vue"],"sourcesContent":["<template>\r\n  <div>\r\n\t\t<table class=\"table\">\r\n\t\t\t<thead>\r\n\t\t\t<tr>\r\n\t\t\t\t<th colspan=\"2\">MVC 게시판-view페이지</th>\r\n\t\t\t</tr>\r\n\t\t\t</thead>\r\n\t\t\t<tbody>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>글쓴이</td>\r\n\t\t\t\t<td>{{board.board_NAME}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>제목</td>\r\n\t\t\t\t<td>{{board.board_SUBJECT}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>내용</td>\r\n\t\t\t\t<td>{{board.board_CONTENT}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>첨부파일</td>\r\n\t\t\t\t<td v-if=\"board.board_FILE\">\r\n\t\t\t\t <div @click=\"download\">\r\n\t\t\t\t\t<span id=\"down\"><img src=\"../../assets/attach.png\">{{board.board_ORIGINAL}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td v-else></td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td colspan=\"2\">\r\n\t\t\t\t\t<button class=\"btn btn-primary start\">댓글</button>\r\n\t\t\t\t\t<span id=\"count\">{{count}}</span>\r\n\r\n\t\t\t\t\t<div class=\"group\"\r\n\t\t\t\t\t\tv-if=\"board.baord_NAME == parent_id || parent_id == 'admin'\">\r\n\t\t\t\t\t\t<router-link :to=\"{name:'Board_Update'}\">\r\n\t\t\t\t\t\t\t<button class=\"btn btn-warning\">수정</button>\r\n\t\t\t\t\t\t</router-link>\r\n\t\t\t\t\t\t<button class=\"btn btn-danger\" @click=\"showModal\">삭제</button>\r\n\t\t\t\t\t</div>\t\r\n\t\t\t\t\t<router-link :to=\"{name:'Board_Reply'}\">\r\n\t\t\t\t\t\t\t<button class=\"btn btn-info\">답변</button>\r\n\t\t\t\t\t</router-link>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<router-link :to=\"{name:'Board_List'}\">\r\n\t\t\t\t\t\t\t<button class=\"btn btn-success\">목록</button>\r\n\t\t\t\t\t</router-link>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t</tbody>\r\n\t\t</table>\r\n\t\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { useStore } from 'vuex';\r\nimport axios from '../../axios/axiossetting.js';\r\nexport default {\r\n\tprops:{\r\n\t\tparent_id:{\r\n\t\t\ttype:String,\r\n\t\t\trequired : true\r\n\t\t}\r\n\t},\r\n\tsetup(){\r\n\t\t//baord_list.vue <router-link :to=\"{name:'Board_Detail',params:{num:`${itme.board_NUM}`}}\"로\r\n\t\t//이동할때 사용된 파라미터 num을 가져옵니다.\r\n\t\tconst num = useRoute().params.num;\r\n\r\n\t\tconst board=ref({});\r\n\t\tconst router=useRouter();\r\n\t\tconst getDetail = async ()=>{\r\n\t\t\ttry{\r\n\t\t\t\tconst res = await axios.get(`boards/${num}`);\r\n\t\t\t\tconsole.log(res.data);\r\n\t\t\t\tboard.value=res.data.board;\r\n\t\t\t\tif(board.value==null){\r\n\t\t\t\t\tconsole.log('null입니다.');\r\n\t\t\t\t\trouter.push(\"{name:'404'}\")\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}catch(err){\r\n\t\t\t\tconsole.log(err)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tgetDetail();\r\n\r\n\t\tconst store=useStore();\r\n\t\tconst count = computed(()=>{\r\n\t\t\treturn store.state.count;\r\n\t\t})\r\n\r\n\t\tconst download = async() => {\r\n\t\t\tconsole.log(board.value.board_FILE);\r\n\t\t\tconsole.log(board.value.board_ORIGINAL);\r\n\t\t\ttry{\r\n\t\t\t\r\n\t\t\t//Blob(Binary Large Object: Blob객체는 text나 2진 데이터 형태로 읽을 수 있습니다.)\r\n\t\t\t\tconst res=await axios.get('boards/down',\r\n\t\t\t\t\t\t\t{  params: {\r\n\t\t\t\t\t\t\t\tfilename: board.value.board_FILE,\r\n\t\t\t\t\t\t\t\toriginal :board.value.board_ORIGINAL\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tresponseType: 'blob'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t);\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tlet bb = new Blob( [res.data]);\r\n\t\t\t//URL.createObjectURL() 정적 메서드는 주어진 객체를 가리키는 URL을 DOMString으로 반환합니다.\r\n\t\t\t//DOMString은 UTF-16 문자열입니다. JavaScript의 String도 UTF-16 문자열이기 때문에 DOMString 은 String으로 연결됩니\r\n\t\t\t// 객체 URL을 해제하려면 revokeObjectURL()을 호출하세요.\r\n\t\t\tlet url=window.URL.createObjectURL (bb);\r\n\t\t\t\r\n\t\t\t//<a href=\"\" download=\"파일오리지널이름\">엘리먼트 생성 후 클릭=>다운로드 수행=>엘리먼트 제거\r\n\t\t\tconst a=document.createElement('a'); // <a> 엘리먼트 생성\r\n\t\t\tlet filename = board.value.board_ORIGINAL;\r\n\t\t\tconsole.log(`filename=${filename}`); //Lemon.png\r\n\r\n\t\t\ta.href=url;\r\n\r\n\t\t\ta.setAttribute('download', `${filename}`);\r\n\r\n\t\t\ta.style.cssText = 'display:none';\r\n\r\n\t\t\tconsole.log(a);\r\n\r\n\t\t\tdocument.body.appendChild(a);\r\n\t\t\ta.click();\r\n\t\t\ta.remove();\r\n\t\t\twindow.URL.revokeObjectURL(url);\r\n\t\t\t}catch(error){\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst showModal = ()=>{\r\n\t\t\t//store에 값을 변경합니다.\r\n\t\t\tstore.dispatch('display', true);\r\n\t\t}\r\n\r\n\t\treturn{\r\n\t\t\tboard, download\r\n\t\t\t,count, showModal\r\n\t\t}\r\n\t}\r\n\r\n}\r\n</script>\r\n\r\n<style  scoped>\r\n\r\n\timg {\r\n\t\twidth:20px;\r\n\t}\r\n\t\r\n\t table > thead,table > tbody > tr:nth-last-child(1) {\r\n\t\ttext-align: center\r\n\t}\r\n\t\r\n\ttd:nth-child(1) {\r\n\t\twidth: 20%\r\n\t}\r\n\t\r\n\t\r\n\ttable > tbody >tr:nth-child(5)>td:nth-child(2)>a {\r\n\t\tcolor: black\r\n\t}\r\n\t\r\n\t\r\n\t.btn-primary {\r\n\t\tbackground-color: #4f97e5\r\n\t}\r\n\t\r\n\t.group{display: inline-block}\r\n\tbutton{\r\n\t\tmargin-left:20px;\r\n\t}\r\n\t\r\n\t#comment > table > tbody > tr > td:nth-child(2){\r\n\t width:60%\r\n\t}\r\n\t#count{\r\n\t position: relative;\r\n\t\ttop: -10px;\r\n\t\tleft: -10px;\r\n\t\tbackground: orange;\r\n\t\tcolor: white;\r\n\t\tborder-radius: 30%;\r\n\t}\r\n\t\r\n\t#down{\r\n\t\tcursor:pointer\r\n\t}\r\n\t\r\n\t</style>\r\n\t\r\n"]},"metadata":{},"sourceType":"module"}