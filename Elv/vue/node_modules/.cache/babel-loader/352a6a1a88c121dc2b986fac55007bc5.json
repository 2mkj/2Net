{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '../assets/pencil.png';\nimport _imports_1 from '../assets/delete.png';\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-af047508\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  id: \"comment\"\n};\nconst _hoisted_2 = {\n  class: \"btn btn-info float-left\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"table table-striped\"\n};\n\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"td\", null, \"아이디\"), /*#__PURE__*/_createElementVNode(\"td\", null, \"내용\"), /*#__PURE__*/_createElementVNode(\"td\", null, \"날짜\")])], -1\n/* HOISTED */\n));\n\nconst _hoisted_5 = {\n  key: 0\n};\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"button\", _hoisted_2, _toDisplayString($setup.count_message), 1\n  /* TEXT */\n  ), _createElementVNode(\"button\", {\n    class: \"btn btn-info float-right\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.add && $setup.add(...args))\n  }, _toDisplayString($setup.button_message), 1\n  /* TEXT */\n  ), _withDirectives(_createElementVNode(\"textarea\", {\n    rows: \"3\",\n    class: \"form-control\",\n    onInput: _cache[1] || (_cache[1] = (...args) => $setup.change && $setup.change(...args)),\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.content = $event),\n    style: {\n      \"resize\": \"none\"\n    },\n    maxLength: \"50\"\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vModelText, $setup.content, void 0, {\n    trim: true\n  }]]), $setup.listcount > 0 ? (_openBlock(), _createElementBlock(\"table\", _hoisted_3, [_hoisted_4, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.list, (item, index) => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: index\n    }, [_createElementVNode(\"td\", null, _toDisplayString(item.id), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", null, _toDisplayString(item.content), 1\n    /* TEXT */\n    ), item.id == $props.parent_id ? (_openBlock(), _createElementBlock(\"td\", _hoisted_5, [_createTextVNode(_toDisplayString(item.reg_date) + \" \", 1\n    /* TEXT */\n    ), _createElementVNode(\"img\", {\n      src: _imports_0,\n      width: \"15px\",\n      onClick: $event => $setup.update(item.content, item.num)\n    }, null, 8\n    /* PROPS */\n    , _hoisted_6), _createElementVNode(\"img\", {\n      src: _imports_1,\n      width: \"15px\",\n      onClick: $event => $setup.del(item.num)\n    }, null, 8\n    /* PROPS */\n    , _hoisted_7)])) : (_openBlock(), _createElementBlock(\"td\", _hoisted_8, _toDisplayString(item.reg_date), 1\n    /* TEXT */\n    ))]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))])])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", {\n    id: \"message\",\n    onClick: _cache[3] || (_cache[3] = (...args) => $setup.more && $setup.more(...args))\n  }, _toDisplayString($setup.message), 1\n  /* TEXT */\n  )]);\n}","map":{"version":3,"mappings":";OAqBWA,gBAA0B;OAC1BC,gBAA0B;;;;;EApB9BC,EAAE,EAAC;;;EACCC,KAAK,EAAC;;;;EAQPA,KAAK,EAAC;;;gEACXC,oBAEQ,OAFR,EAEQ,IAFR,EAEQ,cADNA,oBAA2C,IAA3C,EAA2C,IAA3C,EAA2C,cAAvCA,oBAAY,IAAZ,EAAY,IAAZ,EAAI,KAAJ,CAAuC,eAA3BA,oBAAW,IAAX,EAAW,IAAX,EAAI,IAAJ,CAA2B,eAAhBA,oBAAW,IAAX,EAAW,IAAX,EAAI,IAAJ,CAAgB,CAA3C,CACM,CAFR;;AAAA;;;;;;;;;;;uBAVHC,oBA2BM,KA3BN,cA2BM,CA1BLD,oBAAkE,QAAlE,cAAkEE,iBAAxBC,oBAAwB,CAAlE,EAAuD;EAAA;EAAvD,CA0BK,EAzBLH,oBAAiF,QAAjF,EAAiF;IAAzED,KAAK,EAAC,0BAAmE;IAAvCK,OAAK,yCAAED,iCAAF;EAAkC,CAAjF,mBAAwDA,sBAAxD,EAAsE;EAAA;EAAtE,CAyBK,kBAxBLH,oBAK8B,UAL9B,EAK8B;IALpBK,IAAI,EAAC,GAKe;IAJ1BN,KAAK,EAAC,cAIoB;IAHvBO,OAAK,yCAAIH,uCAAJ,CAGkB;+DAFZA,iBAAOI,OAEK;IADrBC,KAAmB,EAAnB;MAAA;IAAA,CACqB;IAA1BC,SAAS,EAAC;EAAgB,CAL9B;;EAAA,kBAGkBN;UAAd;MAqBC,EAlBoCA,mBAAS,mBAAlDF,oBAgBW,OAhBX,cAgBW,CAfTS,UAeS,EAZTV,oBAWW,OAXX,EAWW,IAXX,EAWW,oBAVZC,oBASKU,SATL,EASK,IATL,EASKC,YATsBT,WAStB,EAT0B,CAAnBU,IAAmB,EAAdC,KAAc,KAAT;yBAAtBb,oBASK,IATL,EASK;MAT6Bc,GAAG,EAAED;IASlC,CATL,EAA4C,CAC3Cd,oBAAoB,IAApB,EAAoB,IAApB,EAAoBE,iBAAdW,IAAI,CAACf,EAAS,CAApB,EAAa;IAAA;IAAb,CAD2C,EAE3CE,oBAAyB,IAAzB,EAAyB,IAAzB,EAAyBE,iBAAnBW,IAAI,CAACG,OAAc,CAAzB,EAAkB;IAAA;IAAlB,CAF2C,EAGjCH,IAAI,CAACf,EAAL,IAASmB,kCAAnBhB,oBAIK,IAJL,EAIKiB,UAJL,EAIK,mCAHFL,IAAI,CAACM,YAAU,KACjB;IAAA;KAEI,EAFJnB,oBAAoF,KAApF,EAAoF;MAA/EoB,GAA0B,EAA1BxB,UAA+E;MAApDyB,KAAK,EAAC,MAA8C;MAAtCjB,OAAK,YAAED,cAAOU,IAAI,CAACG,OAAZ,EAAoBH,IAAI,CAACS,GAAzB;IAA+B,CAApF;;IAAA,aAEI,EADJtB,oBAAoE,KAApE,EAAoE;MAA/DoB,GAA0B,EAA1BvB,UAA+D;MAApCwB,KAAK,EAAC,MAA8B;MAAtBjB,OAAK,YAAED,WAAIU,IAAI,CAACS,GAAT;IAAe,CAApE;;IAAA,aACI,CAJL,oBAKArB,oBAAiC,IAAjC,EAAiCsB,UAAjC,EAAiCrB,iBAApBW,IAAI,CAACM,QAAe,CAAjC,EAA0B;IAAA;IAA1B,EAR2C,CAA5C;GASK,CATL;;EAAA,CAUY,EAXX,CAYS,CAhBX,sCAkBK,EADNnB,oBAAiD,KAAjD,EAAiD;IAA5CF,EAAE,EAAC,SAAyC;IAA9BM,OAAK,yCAAED,mCAAF;EAAyB,CAAjD,mBAAkCA,eAAlC,EAAyC;EAAA;EAAzC,CACM,CA3BN","names":["_imports_0","_imports_1","id","class","_createElementVNode","_createElementBlock","_toDisplayString","$setup","onClick","rows","onInput","$event","style","maxLength","_hoisted_4","_Fragment","_renderList","item","index","key","content","$props","_hoisted_5","reg_date","src","width","num","_hoisted_8"],"sourceRoot":"","sources":["C:\\vue_project\\vue3-first\\src\\ex18_component_store\\component\\commentDo.vue"],"sourcesContent":["\r\n<template>\r\n  <div id=\"comment\">\r\n\t\t\t<button class=\"btn btn-info float-left\">{{count_message}}</button>\r\n\t\t\t<button class=\"btn btn-info float-right\" @click=\"add\">{{button_message}}</button>\r\n\t\t\t<textarea rows=3 \r\n\t\t\t\t\t\t\tclass=\"form-control\"\r\n\t\t\t\t\t  \t\t@input = \"change\" \r\n\t\t\t\t\t\t\tv-model.trim=\"content\"\r\n\t\t\t\t      \t\tstyle=\"resize:none\" \r\n\t\t\t\t\t\t\tmaxLength=\"50\"></textarea>\r\n\t\t\t<table class=\"table table-striped\" v-if=\"listcount>0\">\r\n\t\t\t  <thead>\r\n\t\t\t    <tr><td>아이디</td><td>내용</td><td>날짜</td></tr>\r\n\t\t\t  </thead>\r\n\t\t\t  <tbody>\r\n\t\t\t\t<tr v-for=\"(item,index) in list\" :key=\"index\">\r\n\t\t\t\t\t<td>{{item.id}}</td>\r\n\t\t\t\t\t<td>{{item.content}}</td>\r\n\t\t\t\t\t<td v-if=\"item.id==parent_id\">\r\n\t\t\t\t\t\t{{item.reg_date}}\r\n\t\t\t\t\t\t<img src=\"../assets/pencil.png\" width=\"15px\" @click=\"update(item.content,item.num)\">\r\n\t\t\t\t\t\t<img src=\"../assets/delete.png\" width=\"15px\" @click=\"del(item.num)\">\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td v-else>{{item.reg_date}}</td>\r\n\t\t\t\t</tr>\r\n\t\t      </tbody>\r\n\t\t    </table>\r\n\t\t<div id=\"message\" @click=\"more\">{{message}}</div>\r\n\t\t</div>\r\n</template>\r\n\r\n<script>\r\nimport axios from '../axios/axiossetting.js';\r\nimport {useRoute} from 'vue-router'\r\nimport {ref} from 'vue';\r\nimport {useStore} from 'vuex';\r\nexport default {\r\n\tprops:{\r\n\t\tparent_id:{\r\n\t\t\ttype:String,\r\n\t\t\trequired:true\r\n\t\t}\r\n\t},\r\n\tsetup(props){\r\n\t\t//board_list.vue에서 <router-link :to=\"{name:'Board_Detail'},params:{num:`${item.board_NUM`}}\"로\r\n\t\t//이동할 때 사용된 파라미터 num을 가져옵니다.\r\n\t\tconst board_num = useRoute().params.num;\r\n\t\tconst el = ref(null);\r\n\r\n\t\tlet page=1;\r\n\t\tconst listcount = ref(0);\r\n\t\tconst list = ref([]);\r\n\t\tconst content = ref('');\r\n\t\tconst message = ref(\"등록된 댓글이 없습니다.\");\r\n\t\tconst button_message = ref(\"등록\");\r\n\t\tconst count_message=ref(\"총 50자까지 가능합니다.\");\r\n\t\tlet comment_num =0;\r\n\t\tconst store = useStore(); //component/board/board_detail.vue에서 사용될 count를 보내기위해 사용합니다.\r\n\r\n\t\tconst getList = async(page)=>{\r\n\t\t\ttry{\r\n\t\t\t\tconst res = await axios.get(\"comments\",{params:{board_num : board_num, page:page}})\r\n\t\t\t\tlistcount.value = res.data.listcount;\r\n\t\t\t\tlist.value = res.data.list;\r\n\r\n\t\t\t\tif(listcount.value==0){\r\n\t\t\t\t\tmessage.value=\"등록된 댓글이 없습니다.\"\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(listcount.value > list.value.length){\r\n\t\t\t\t\t\tmessage.value=\"더보기\";\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tmessage.value=\"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcount_message.value=\"총 50자까지 가능합니다.\"\r\n\r\n\t\t\t\t//store에 저장\r\n\t\t\t\tstore.dispatch('count', listcount.value);\r\n\t\t\t}catch(err){\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tgetList(1);\r\n\r\n\t\tconst limit = 50; // 총 50자까지 가능\r\n\t\tconst change = (event)=>{\r\n\t\t\tlet value = event.target.value;\r\n\t\t\tlet length = value.length;\r\n\t\t\tif(length>limit){\r\n\t\t\t\tvalue = value.substring(0, limit);\r\n\t\t\t\tlength = limit;\r\n\t\t\t}\r\n\t\t\tcount_message.value=length + \"/\" +limit;\r\n\t\t}\r\n\r\n\t\tconst add = async ()=>{\r\n\t\t\tif(!content.value){\r\n\t\t\t\t\talert(\"내용을 입력하세요\");\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet res;\r\n\t\t\t\r\n\t\t\ttry{\r\n\t\t\t\tif(button_message.value==\"등록\"){\r\n\t\t\t\t\tres = await axios.post(\"comments/new\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{board_num:board_num,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent:content.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid:props.parent_id});\r\n\t\t\t\t\tconsole.log(res.data);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tres = await axios.patch(\"comments\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{num:comment_num,content:content.value});\r\n\t\t\t\t\tbutton_message.value=\"등록\";\r\n\t\t\t\t\tconsole.log(res.data);\r\n\t\t\t\t}\r\n\t\t\t\tcontent.value=\"\";\r\n\t\t\t\tif(res.data==1)\r\n\t\t\t\t\t\tgetList(1);\r\n\r\n\t\t\t}catch(err){\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t}\r\n\t\t}//add end\r\n\r\n\t\tconst del  = async (num)=>{\r\n\t\t\tconsole.log(\"삭제 num=\"+num)\r\n\t\t\tif(!confirm(\"정말 삭제하시겠습니까?\")){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttry{\t\r\n\t\t\t\tconst res=await axios.delete(`comments/${num}`);\r\n\t\t\t\tif(res.data==1)\r\n\t\t\t\t\tgetList(1);\r\n\t\t\t}catch(err){\r\n\t\t\t\tconsole.log(err)\r\n\t\t\t}\r\n\t\t}//del end\r\n\r\n\t\tconst update = (con, num)=>{\r\n\t\t\tbutton_message.value=\"수정완료\";\r\n\t\t\tcontent.value=con;\r\n\t\t\tcomment_num=num;\r\n\t\t\tcount_message.value=con.length+\"/\"+limit\r\n\t\t\tel.value.focus();\r\n\t\t}\r\n\r\n\t\tconst more = ()=>{\r\n\t\t\tgetList(++page);\r\n\t\t}\r\n\r\n\t\treturn{\r\n\t\t\tmessage, listcount, list, content, button_message, count_message,\r\n\t\t\tadd, update, del, more, change\r\n\t\t}\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\timg {\r\n\t\twidth:15px;\r\n\t}\r\n\t#comment > table > tbody > tr  td:nth-child(1) {width:20%}\r\n\t#comment > table > tbody > tr  td:nth-child(2) {width:50%}\r\n\t.float-right {margin-right: 0px;}\r\n\t\r\n\t</style>\r\n\t"]},"metadata":{},"sourceType":"module"}